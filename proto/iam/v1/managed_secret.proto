// File: proto/iam/v1/managed_secret.proto
// Defines the ManagedSecret message, a non-sensitive reference to a secret in the vault.
syntax = "proto3";

package iam.v1;

import "google/protobuf/timestamp.proto";

option go_package = "github.com/spoungeai/spounge-protos/gen/go/iam/v1;iamv1";

// Enum for the types of managed secrets.
enum ManagedSecretType {
  MANAGED_SECRET_TYPE_UNSPECIFIED = 0;
  MANAGED_SECRET_TYPE_OPENAI = 1;
  MANAGED_SECRET_TYPE_SLACK = 2;
  MANAGED_SECRET_TYPE_GITHUB = 3;
  MANAGED_SECRET_TYPE_ANTHROPIC = 4;
  MANAGED_SECRET_TYPE_GOOGLE_AI = 5;
  MANAGED_SECRET_TYPE_CUSTOM = 6;
}

// ManagedSecret is a reference to a credential stored securely in a vault.
// It does not contain the secret value itself.
message ManagedSecret {
  // The unique identifier for the secret reference.
  string id = 1;
  // The ID of the user who owns this secret.
  string user_id = 2;
  // A user-defined name for the secret.
  string name = 3;
  // The type of the secret, which can hint at its usage.
  ManagedSecretType type = 4;
  // Timestamp when the secret reference was created.
  google.protobuf.Timestamp created_at = 5;
  // Timestamp when the secret reference was last updated.
  google.protobuf.Timestamp updated_at = 6;
}